syntax = "proto3";

package proto;

option go_package = "github.com/WjcHome/gohello/proto";

// 消息类型枚举
enum MessageType {
  MESSAGE_UNKNOWN = 0;
  MESSAGE_CONNECT = 1;        // 客户端连接
  MESSAGE_FRAME_DATA = 2;     // 帧数据（8个方向）
  MESSAGE_SERVER_FRAME = 3;   // 服务器帧同步数据
  MESSAGE_DISCONNECT = 4;     // 断开连接
  MESSAGE_GAME_START = 5;     // 游戏开始
  
  MESSAGE_FRAME_LOSS = 6;     // 缺失帧
  MESSAGE_FRAME_NEED = 7;     // 补发帧
  MESSAGE_HEARTBEAT = 8;      // 心跳（C->S）
}

// 输入方向（8个方向）
enum InputDirection {
  DIRECTION_NONE = 0;
  DIRECTION_UP = 1;
  DIRECTION_DOWN = 2;
  DIRECTION_LEFT = 3;
  DIRECTION_RIGHT = 4;
  DIRECTION_UP_LEFT = 5;      // 左上
  DIRECTION_UP_RIGHT = 6;     // 右上
  DIRECTION_DOWN_LEFT = 7;    // 左下
  DIRECTION_DOWN_RIGHT = 8;    // 右下
}

// 客户端帧数据（包含8个方向）
message FrameData {
  int32 player_id = 1;              // 玩家ID
  InputDirection direction = 2;     // 方向（8个方向）
  int64 frame_number = 3;            // 帧号
  bool is_fire = 4;                 // 是否射击
  optional int64 fire_x = 5;        // 射击目标X坐标（可选，仅当is_fire=true时有效）
  optional int64 fire_y = 6;        // 射击目标Y坐标（可选，仅当is_fire=true时有效）
}

// 服务器帧同步数据
message ServerFrame {
  int64 frame_number = 1;            // 帧号
  int64 timestamp = 2;                // 时间戳
  repeated FrameData frame_datas = 3; // 所有玩家的帧数据
}

// 连接消息
message ConnectMessage {
  int32 player_id = 1;
  string player_name = 2;
}



// 断开连接消息
message DisconnectMessage {
  int32 player_id = 1;
}

// 游戏开始消息
message GameStart {
  string room_id = 1;              // 房间ID
  int64 random_seed = 2;           // 随机种子
  repeated int32 player_ids = 3;  // 玩家ID列表
}




message GetLossFrame{
  int64 last_frame_number = 1;  
}
message SendAllFrame{
  repeated ServerFrame all_need_frame = 1;
}

// 心跳消息（空消息体）
message Heartbeat {
}